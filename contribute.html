

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Contribute &mdash; dripline 0.0.2 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="dripline 0.0.2 documentation" href="index.html"/>
        <link rel="next" title="Tutorials" href="tutorials.html"/>
        <link rel="prev" title="Specifications" href="spec.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> dripline</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#libraries">Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#operating-system-python">Operating System &amp; Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spec.html">Specifications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spec.html#abstractions">Abstractions</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec.html#messages">Messages</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Contribute</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tdd-with-dripline">TDD with Dripline</a></li>
<li class="toctree-l2"><a class="reference internal" href="#contributing-with-tdd">Contributing with TDD</a></li>
<li class="toctree-l2"><a class="reference internal" href="#don-t-stop-there">Don&#8217;t stop there</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-tests">Adding Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mocking">Mocking</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials.html#a-dripline-powered-key-value-store">A Dripline powered key-value store</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cli_tools.html">Command Line Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cli_tools.html#dripline-agent">dripline_agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli_tools.html#start-node">start_node</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli_tools.html#message-monitor">message_monitor</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">dripline</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Contribute</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/contribute.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="contribute">
<h1>Contribute<a class="headerlink" href="#contribute" title="Permalink to this headline">¶</a></h1>
<p>Part of the motivation for moving to this incarnation of dripline is to make it easier for anyone to contribute.
We&#8217;re trying to keep test coverage high, so a recommended test driven development workflow is (going to be soon, hopefully,) described below.</p>
<p>As always, <a class="reference external" href="github.com/project8/dripline">dripline is on github</a>.
Branches are cheap, lets do more of those.
For more details, <a class="reference external" href="nvie.com/posts/a-successful-git-branching-model">this branching model</a> has served us very well to date.
In particular, please note that master is for tagged/release versions while develop is the latest working version.</p>
<div class="section" id="tdd-with-dripline">
<h2>TDD with Dripline<a class="headerlink" href="#tdd-with-dripline" title="Permalink to this headline">¶</a></h2>
<p>Test driven development is a paradigm where having code that successfully passes some tests (called Unit Tests) is
the decision metric for when a piece of code is up to standards.</p>
<p>Consider a very simple piece of code shown below:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Adder</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span>
</pre></div>
</div>
<p>The above code has an obvious typo - we are subtracting in the <tt class="docutils literal"><span class="pre">add</span></tt> method where we clearly meant to add.  If we
deployed this code in production, at some point it would break, and we would have to do some extensive debugging to
figure out where.  This type of error is especially insidious as we would have to figure out not just that the
arithmetic was bad, but also <em>where</em> the arithmetic went wrong.</p>
<p>If instead, we wrote the following piece of testing code <em>before we even implemented the class</em>, we would catch it
immediately:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">test_my_adder</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">an_adder</span> <span class="o">=</span> <span class="n">Adder</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">an_adder</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span>
</pre></div>
</div>
<p>This is the crux of test driven development: we want to write tests that establish a contract for the code that we
haven&#8217;t written yet.  We know how we <em>want</em> it to behave - and so we specify that as a test, and have a testing framework
run our tests for us.  Dripline uses the excellent <a class="reference external" href="http://pytest.org">py.test</a> for this, and an extensive number of tests
is in the <tt class="docutils literal"><span class="pre">test</span></tt> subdirectory of the dripline source tree.</p>
</div>
<div class="section" id="contributing-with-tdd">
<h2>Contributing with TDD<a class="headerlink" href="#contributing-with-tdd" title="Permalink to this headline">¶</a></h2>
<p>Think of the tests as a contract.  If you modify some code, and tests start failing, identify the source of the failure
and fix the code.  More than likely, if your contribution is self-contained, you won&#8217;t break tests that belong to other
parts of the code - in other words, you are fulfilling the contract that is laid out by the tests.</p>
<p>To start, write down the contract in the tests directory as a file called <tt class="docutils literal"><span class="pre">test_whatever.py</span></tt> where whatever has something
to do with the code that you&#8217;re writing.  Looking at e.g. <tt class="docutils literal"><span class="pre">test_factory.py</span></tt> may be a good place to get some inspiration,
as the code is extremely simple and highlights the basic idea:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">from</span> <span class="nn">agilent34461a</span> <span class="kn">import</span> <span class="n">Agilent34461a</span>
<span class="kn">from</span> <span class="nn">factory</span> <span class="kn">import</span> <span class="n">constructor_registry</span>

<span class="k">def</span> <span class="nf">test_reg_factory</span><span class="p">():</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">constructor_registry</span><span class="p">[</span><span class="s">&#39;agilent34461a&#39;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">c</span> <span class="o">==</span> <span class="n">Agilent34461a</span>
</pre></div>
</div>
<p>This is extremely simple and verifies the core functionality of a piece of the dripline code.  Note that the test is
completely disinterested in the <em>internal</em> way in which the constructor_registry is built - all it cares about is that
the expected behavior is correct.</p>
<p>On that note, write tests that express the ideas you have about how your code ought to work.  If there are logical statements
or invariants that must be true for your code, write them as tests.  If you are writing a class that has some well-defined
API, ensure that it works as you expect it to!  If you have two methods on some object called <tt class="docutils literal"><span class="pre">set_x</span></tt> and <tt class="docutils literal"><span class="pre">get_x</span></tt>,
write a test to make sure that a call to <tt class="docutils literal"><span class="pre">get_x</span></tt> after <tt class="docutils literal"><span class="pre">set_x</span></tt> returns what you expect.</p>
</div>
<div class="section" id="don-t-stop-there">
<h2>Don&#8217;t stop there<a class="headerlink" href="#don-t-stop-there" title="Permalink to this headline">¶</a></h2>
<p>Once your tests pass, you&#8217;ve successfully fulfilled the contract - which is not the same as having the code that
you really want.  This is a great place to stop and refactor your code to be high quality, while still running tests
after changing things to verify that you haven&#8217;t broken anything.  Doing things this way means that while you are
making your code pretty, the chances of making it wrong are dramatically reduced!</p>
</div>
<div class="section" id="adding-tests">
<h2>Adding Tests<a class="headerlink" href="#adding-tests" title="Permalink to this headline">¶</a></h2>
<p>If you suspect that some part of the dripline codebase may be fragile or break in some edge case, feel free to add a test
to try it!  It&#8217;s much much simpler to write a single function than an entire program to test some aspect of the code.</p>
</div>
<div class="section" id="mocking">
<h2>Mocking<a class="headerlink" href="#mocking" title="Permalink to this headline">¶</a></h2>
<p>Dripline is inherently network oriented, but when we are running tests we want to be isolated from connections to the
network.  To get around this and test the functionality of our code, it is necessary to <em>mock</em> certain functions and
classes so that the behavior of our code can be tested independently of communication with the outside world.</p>
<p>This may be a limitation in some respect, but note that you can mock a function in such a way that it will return whatever
you might expect from a remote host, and therefore preserve the logic of your program.</p>
<p>Mocking is a subject unto itself - see examples in <tt class="docutils literal"><span class="pre">test_node.py</span></tt>, or read more extensively about the mocking capabilities
in py.test <a class="reference external" href="http://pytest.org/latest/monkeypatch.html">here</a></p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorials.html" class="btn btn-neutral float-right" title="Tutorials"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="spec.html" class="btn btn-neutral" title="Specifications"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Jared Kofron, Ben LaRoque.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>